name: Backend Deployment

on:
push:
branches:
- main

jobs:
deploy:
name: Deploy to Production
runs-on: self-hosted

```
strategy:
  matrix:
    node-version: [20]

steps:
  - name: Checkout repository
    uses: actions/checkout@v4

  - name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: ${{ matrix.node-version }}
      cache: npm

  - name: Install dependencies
    run: |
      cd /home/ubuntu/crm_backend/actions-runner/_work/Crm-backend-secondary-files/Crm-backend-secondary-files
      rm -rf node_modules
      npm install --force

  - name: Restart PM2 process
    run: |
      cd /home/ubuntu/crm_backend/actions-runner/_work/Crm-backend-secondary-files/Crm-backend-secondary-files
      sudo pm2 delete crm_backend || true
      sudo pm2 start server.js --name crm_backend
      sudo pm2 save
```
